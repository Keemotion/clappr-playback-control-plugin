!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("clappr")):"function"==typeof define&&define.amd?define(["clappr"],e):"object"==typeof exports?exports.PlaybackControlPlugin=e(require("clappr")):t.PlaybackControlPlugin=e(t.clappr)}(this,function(t){return function(t){function e(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return t[a].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="<%=baseUrl%>/",e(0)}([function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=t[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!e||n.length!==e);a=!0);}catch(c){r=!0,o=c}finally{try{!a&&l["return"]&&l["return"]()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),s=function N(t,e,n){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,e);if(void 0===a){var r=Object.getPrototypeOf(t);return null===r?void 0:N(r,e,n)}if("value"in a)return a.value;var o=a.get;if(void 0!==o)return o.call(n)},u=n(5),p=a(u),f=n(4),d=a(f),y=n(3),h=a(y),b=n(1),k=a(b),v="frames",g="seconds",m="down",w="up",C="1",P="2",x="3",S="4",_="5",M={};M[C]=-15,M[P]=-5,M[S]=5,M[_]=15;var O={"-7":-32,"-6":-16,"-5":-8,"-4":-4,"-3":-2,"-2":-1,"-1":-.5,0:0,1:.5,2:1,3:2,4:4,5:8,6:16,7:32},E={fps:29},T=function(t){function e(){return r(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return i(e,t),c(e,[{key:"setManualPlaybackRate",value:function(t){var e=this;if(t!==this.manualPlaybackRate){if(this.manualPlaybackRate=t,clearInterval(this.manualPlaybackId),0===Number(t))return void this.player.pause();var n=.1;this.manualPlaybackId=setInterval(function(){e.playback.trigger("seeking");var a=n*t;e.playback.bufferingState?(console.warn("cannot seek - buffering, skip at twice the distance"),e.seekTime(2*a)):e.seekTime(a),e.playback.trigger("waiting")},1e3*n)}}},{key:"togglePlayback",value:function(){this.player.isPlaying()?this.player.pause():this.player.play()}},{key:"onContainerChanged",value:function(){this.invalidate()}},{key:"findButton",value:function(t,e){var n=e>0?"+"+e:e;return this.$el.find('[data-step-scale="'+t+'"][data-step-value="'+n+'"]')}},{key:"highlightButton",value:function(t,e,n){var a=this.findButton(t,e);switch(n){case m:a.children()[1].className="playback-control-action-highlight";break;case w:a.children()[1].className=""}return a}},{key:"onButtonClick",value:function(t){var e=t.currentTarget,n=e.getAttribute("data-step-scale"),a=Number(e.getAttribute("data-step-value"));this.seekScaleValue(n,a)}},{key:"onActionsMouseWheel",value:function(t){var e=t.currentTarget,n=e.getAttribute("data-step-scale"),a=t.detail<0||t.wheelDelta>0?1:-1;return this.seekScaleValue(n,a),t.stopPropagation(),t.preventDefault(),!1}},{key:"bindEvents",value:function(){this.listenTo(this.mediaControl,p["default"].Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.mediaControl,p["default"].Events.MEDIACONTROL_CONTAINERCHANGED,this.onContainerChanged),d["default"].reset();var t=!0,e=!1,n=void 0;try{for(var a,r=Object.entries(this.userInputActionsMap)[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var o=l(a.value,2),i=o[1],c=!0,s=!1,u=void 0;try{for(var f,y=Object.entries(i.events)[Symbol.iterator]();!(c=(f=y.next()).done);c=!0){var h=l(f.value,2),b=h[0],k=h[1];d["default"].bind(i.keys,k,b)}}catch(v){s=!0,u=v}finally{try{!c&&y["return"]&&y["return"]()}finally{if(s)throw u}}}}catch(v){e=!0,n=v}finally{try{!t&&r["return"]&&r["return"]()}finally{if(e)throw n}}}},{key:"stopListening",value:function(){s(Object.getPrototypeOf(e.prototype),"stopListening",this).call(this),this.onMouseWheelDelegate&&(this.onMouseWheelDelegate.unbind(),this.onMouseWheelDelegate=null),this.manualPlaybackRate=0,clearInterval(this.manualPlaybackId)}},{key:"render",value:function(){var t=p["default"].Styler.getStyleFor(k["default"]);return this.$el.html(this.template()).append(t),this.$el.find('[type="button"]').off("click").on("click",this.onButtonClick.bind(this)),this.$el.find(".playback-control-actions").off("DOMMouseScroll").on("DOMMouseScroll",this.onActionsMouseWheel.bind(this)),this.$el.find(".playback-control-actions").off("mousewheel").on("mousewheel",this.onActionsMouseWheel.bind(this)),this.mediaControl.$(".media-control-left-panel[data-media-control]").append(this.el),this}},{key:"invalidate",value:function(){this.stopListening(),this.bindEvents()}},{key:"getFPS",value:function(){var t=E.fps;return this.player&&this.player.options&&this.player.options.playbackControl&&(t=this.player.options.playbackControl.fps||t),t}},{key:"seekRelativeFrames",value:function(t){var e=this.player;e.isPlaying()&&e.pause();var n=e.getCurrentTime(),a=n+t/this.getFPS();if(a<=0||a>=e.getDuration());else{var r=this.core.getCurrentPlayback();e.seek(a);for(var o=r.el.buffered,i=!1,l=0;l<o.length;l++)if(a>=o.start(l)&&a<=o.end(l)){i=!0;break}i||r.trigger("waiting")}}},{key:"seekRelativeSeconds",value:function(t){var e=this.player;e.isPlaying()&&e.pause();var n=e.getCurrentTime()+t;n<0?n=0:n>e.getDuration()&&(n=e.getDuration()),null===n||isNaN(n)?console.error("Invalid seek position"):e.seek(n)}},{key:"seekTime",value:function(t){return this.mediaControl.seekRelative(t)}},{key:"seekScaleValue",value:function(t,e){switch(t){case v:this.seekRelativeFrames(e);break;case g:this.seekRelativeSeconds(e)}}},{key:"name",get:function(){return"playback_control"}},{key:"version",get:function(){return PLUGIN_VERSION}},{key:"template",get:function(){return p["default"].template(h["default"])}},{key:"attributes",get:function(){return{"class":"playback-control"}}},{key:"mediaControl",get:function(){return this.core.mediaControl}},{key:"playback",get:function(){return this.core.getCurrentPlayback()}},{key:"player",get:function(){return this.mediaControl.container}},{key:"config",get:function(){return this.core.options.playbackControlConfig||E}},{key:"userInputActionsMap",get:function(){var t=this,e={"nav-frame-dec":{keys:["left"],events:{keydown:function(){return t.highlightButton(v,-1,m)},keyup:function(){t.highlightButton(v,-1,w),t.seekScaleValue(v,-1)}}},"nav-frame-inc":{keys:["right"],events:{keydown:function(){return t.highlightButton(v,1,m)},keyup:function(){t.highlightButton(v,1,w),t.seekScaleValue(v,1)}}},"nav-second-dec":{keys:["down"],events:{keydown:function(){return t.highlightButton(g,-1,m)},keyup:function(){t.highlightButton(g,-1,w),t.seekScaleValue(g,-1)}}},"nav-second-inc":{keys:["up"],events:{keydown:function(){return t.highlightButton(g,1,m)},keyup:function(){t.highlightButton(g,1,w),t.seekScaleValue(g,1)}}},"nav-second-jmp":{keys:["alt+shift+1","alt+shift+2","alt+shift+3","alt+shift+4","alt+shift+5"],events:{keydown:function(e){var n=String.fromCharCode(e.keyCode);if(n===x)t.togglePlayback();else{var a=M[n];t.seekScaleValue(g,a)}}}},"playback-pauseresume":{keys:["p"],events:{keypress:function(){return t.togglePlayback}}},"playback-switchrate":{keys:["ctrl+shift+alt+2","ctrl+shift+alt+3","ctrl+shift+alt+4","ctrl+shift+alt+5","ctrl+shift+alt+6","ctrl+shift+alt+7","ctrl+shift+alt+8","ctrl+shift+1","ctrl+shift+2","ctrl+shift+3","ctrl+shift+4","ctrl+shift+5","ctrl+shift+6","ctrl+shift+7","ctrl+shift+8"],events:{keydown:function(e){var n=String.fromCharCode(e.keyCode),a=e.altKey?-1:1,r=(Number(n)-1)*a,o=O[r];t.setManualPlaybackRate(o)}}}};return e}}]),e}(p["default"].UICorePlugin);e["default"]=T},function(t,e,n){e=t.exports=n(2)(),e.push([t.id,"[data-player] div.playback-control{float:left}[data-player] div.playback-control>.playback-control-actions{display:inline-block;margin-left:1px;margin-right:1px;height:28px}[data-player] div.playback-control>.playback-control-actions:hover{background:#eee}[data-player] div.playback-control>.playback-control-actions>button{outline:none;cursor:pointer;border:1px solid #444;margin:1px;text-align:center;width:35px;height:26px}[data-player] div.playback-control>.playback-control-actions>button>sub{outline:none;position:relative;display:inline-block;background:#eee;border-radius:15px;width:25px;border:1px solid;left:-2px;bottom:0;font-weight:700;font-family:Consolas,Lucida Console,Monaco,monospace;font-size:11px}[data-player] div.playback-control>.playback-control-actions>button>sub.playback-control-action-highlight{background:#febf04;border-color:#333;color:#333;position:relative;top:1px;left:1px}[data-player] div.playback-control>.playback-control-actions>button:hover{background:#333;color:#eee}[data-player] div.playback-control>.playback-control-actions>button:hover>sub{border-color:#eee;color:#333}[data-player] div.playback-control>.playback-control-actions>button:active{background:#666;color:#333;border-color:#111;position:relative;top:1px}[data-player] div.playback-control>.playback-control-actions>button:active>sub{background:#111;color:#666;border-color:#111;font-weight:700}[data-player] div.playback-control>.playback-control-actions>button::-moz-focus-inner{border:0}[data-player] div.playback-control>.playback-control-actions[data-step-scale=seconds]>button{background:#00b7ea}[data-player] div.playback-control>.playback-control-actions[data-step-scale=frames]>button{background:#d2ff52}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(a[o]=!0)}for(r=0;r<e.length;r++){var i=e[r];"number"==typeof i[0]&&a[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),t.push(i))}},t}},function(t,e){t.exports='<div class="playback-control-actions" data-step-scale="frames">\n  <button type="button" data-step-value="-1" data-step-scale="frames" title="Step 1 frame backward">\n    <p>-1</p>\n    <sub>&larr;</sub>\n  </button>\n  <button type="button" data-step-value="+1" data-step-scale="frames" title="Step 1 frame forward">\n    <p>+1</p>\n    <sub>&rarr;</sub>\n  </button>\n</div>\n<div class="playback-control-actions" data-step-scale="seconds">\n  <button type="button" data-step-value="-1" data-step-scale="seconds" title="Step 1 second backward">\n    <p>-1</p>\n    <sub>&darr;</sub>\n  </button>\n  <button type="button" data-step-value="+1" data-step-scale="seconds" title="Step 1 second forward">\n    <p>+1</p>\n    <sub>&uarr;</sub>\n  </button>\n</div>\n'},function(t,e,n){var a;!function(r,o,i){function l(t,e,n){return t.addEventListener?void t.addEventListener(e,n,!1):void t.attachEvent("on"+e,n)}function c(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return w[t.which]?w[t.which]:C[t.which]?C[t.which]:String.fromCharCode(t.which).toLowerCase()}function s(t,e){return t.sort().join(",")===e.sort().join(",")}function u(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}function p(t){return t.preventDefault?void t.preventDefault():void(t.returnValue=!1)}function f(t){return t.stopPropagation?void t.stopPropagation():void(t.cancelBubble=!0)}function d(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function y(){if(!m){m={};for(var t in w)t>95&&t<112||w.hasOwnProperty(t)&&(m[w[t]]=t)}return m}function h(t,e,n){return n||(n=y()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}function b(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus"),t.split("+"))}function k(t,e){var n,a,r,o=[];for(n=b(t),r=0;r<n.length;++r)a=n[r],x[a]&&(a=x[a]),e&&"keypress"!=e&&P[a]&&(a=P[a],o.push("shift")),d(a)&&o.push(a);return e=h(a,o,e),{key:a,modifiers:o,action:e}}function v(t,e){return null!==t&&t!==o&&(t===e||v(t.parentNode,e))}function g(t){function e(t){t=t||{};var e,n=!1;for(e in m)t[e]?n=!0:m[e]=0;n||(P=!1)}function n(t,e,n,a,r,o){var i,l,c=[],u=n.type;if(!b._callbacks[t])return[];for("keyup"==u&&d(t)&&(e=[t]),i=0;i<b._callbacks[t].length;++i)if(l=b._callbacks[t][i],(a||!l.seq||m[l.seq]==l.level)&&u==l.action&&("keypress"==u&&!n.metaKey&&!n.ctrlKey||s(e,l.modifiers))){var p=!a&&l.combo==r,f=a&&l.seq==a&&l.level==o;(p||f)&&b._callbacks[t].splice(i,1),c.push(l)}return c}function a(t,e,n,a){b.stopCallback(e,e.target||e.srcElement,n,a)||t(e,n)===!1&&(p(e),f(e))}function r(t){"number"!=typeof t.which&&(t.which=t.keyCode);var e=c(t);if(e)return"keyup"==t.type&&w===e?void(w=!1):void b.handleKey(e,u(t),t)}function i(){clearTimeout(v),v=setTimeout(e,1e3)}function y(t,n,r,o){function l(e){return function(){P=e,++m[t],i()}}function s(n){a(r,n,t),"keyup"!==o&&(w=c(n)),setTimeout(e,10)}m[t]=0;for(var u=0;u<n.length;++u){var p=u+1===n.length,f=p?s:l(o||k(n[u+1]).action);h(n[u],f,o,t,u)}}function h(t,e,a,r,o){b._directMap[t+":"+a]=e,t=t.replace(/\s+/g," ");var i,l=t.split(" ");return l.length>1?void y(t,l,e,a):(i=k(t,a),b._callbacks[i.key]=b._callbacks[i.key]||[],n(i.key,i.modifiers,{type:i.action},r,t,o),void b._callbacks[i.key][r?"unshift":"push"]({callback:e,modifiers:i.modifiers,action:i.action,seq:r,level:o,combo:t}))}var b=this;if(t=t||o,!(b instanceof g))return new g(t);b.target=t,b._callbacks={},b._directMap={};var v,m={},w=!1,C=!1,P=!1;b._handleKey=function(t,r,o){var i,l=n(t,r,o),c={},s=0,u=!1;for(i=0;i<l.length;++i)l[i].seq&&(s=Math.max(s,l[i].level));for(i=0;i<l.length;++i)if(l[i].seq){if(l[i].level!=s)continue;u=!0,c[l[i].seq]=1,a(l[i].callback,o,l[i].combo,l[i].seq)}else u||a(l[i].callback,o,l[i].combo);var p="keypress"==o.type&&C;o.type!=P||d(t)||p||e(c),C=u&&"keydown"==o.type},b._bindMultiple=function(t,e,n){for(var a=0;a<t.length;++a)h(t[a],e,n)},l(t,"keypress",r),l(t,"keydown",r),l(t,"keyup",r)}if(r){for(var m,w={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},C={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},P={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},x={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},S=1;S<20;++S)w[111+S]="f"+S;for(S=0;S<=9;++S)w[S+96]=S;g.prototype.bind=function(t,e,n){var a=this;return t=t instanceof Array?t:[t],a._bindMultiple.call(a,t,e,n),a},g.prototype.unbind=function(t,e){var n=this;return n.bind.call(n,t,function(){},e)},g.prototype.trigger=function(t,e){var n=this;return n._directMap[t+":"+e]&&n._directMap[t+":"+e]({},t),n},g.prototype.reset=function(){var t=this;return t._callbacks={},t._directMap={},t},g.prototype.stopCallback=function(t,e){var n=this;return!((" "+e.className+" ").indexOf(" mousetrap ")>-1)&&(!v(e,n.target)&&("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable))},g.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},g.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(w[e]=t[e]);m=null},g.init=function(){var t=g(o);for(var e in t)"_"!==e.charAt(0)&&(g[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},g.init(),r.Mousetrap=g,"undefined"!=typeof t&&t.exports&&(t.exports=g),a=function(){return g}.call(e,n,e,t),!(a!==i&&(t.exports=a))}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},function(e,n){e.exports=t}])});
//# sourceMappingURL=clappr-playback-control-plugin.min.js.map